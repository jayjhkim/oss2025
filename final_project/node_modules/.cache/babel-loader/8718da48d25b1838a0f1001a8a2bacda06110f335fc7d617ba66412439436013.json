{"ast":null,"code":"// EVDataService.js\nimport proj4 from \"proj4\";\nconst API_URL = \"http://localhost:4000/api/charging\";\n\n// TM ì¤‘ë¶€ì›ì (EPSG:2097) â†’ WGS84 ë³€í™˜ ì •ì˜\nconst tmProjection = \"+proj=tmerc +lat_0=38 +lon_0=127 +k=1 +x_0=200000 +y_0=500000 +ellps=bessel +units=m +no_defs\";\nconst wgs84 = \"+proj=longlat +datum=WGS84 +no_defs\";\n\n// TM â†’ ìœ„ë„/ê²½ë„ ë³€í™˜ í•¨ìˆ˜\nfunction convertTMtoLatLng(x, y) {\n  const [lng, lat] = proj4(tmProjection, wgs84, [parseFloat(x), parseFloat(y)]);\n  return {\n    lat,\n    lng\n  };\n}\nexport const EVDataService = {\n  // ðŸ”¥ ì‹¤ì œ SafeMap API í˜¸ì¶œ\n  async getStations() {\n    try {\n      var _ref, _ref2, _data$response$body$i, _data$response, _data$response$body, _data$response$body$i2;\n      const res = await fetch(API_URL);\n      const data = await res.json();\n\n      // SafeMap ì‘ë‹µ êµ¬ì¡°: { response: { body: { items: { item: [...] } } } }\n      const items = (_ref = (_ref2 = (_data$response$body$i = data === null || data === void 0 ? void 0 : (_data$response = data.response) === null || _data$response === void 0 ? void 0 : (_data$response$body = _data$response.body) === null || _data$response$body === void 0 ? void 0 : (_data$response$body$i2 = _data$response$body.items) === null || _data$response$body$i2 === void 0 ? void 0 : _data$response$body$i2.item) !== null && _data$response$body$i !== void 0 ? _data$response$body$i : data === null || data === void 0 ? void 0 : data.items) !== null && _ref2 !== void 0 ? _ref2 : data === null || data === void 0 ? void 0 : data.item) !== null && _ref !== void 0 ? _ref : [];\n\n      // ë°°ì—´ì´ ì•„ë‹ˆë©´ ë³€í™˜\n      const array = Array.isArray(items) ? items : [items];\n\n      // âš¡ Leafletì—ì„œ ì“°ê¸° ì¢‹ì€ êµ¬ì¡°ë¡œ ë³€í™˜\n      const mapped = array.map(item => {\n        if (!item.X || !item.Y) return null;\n        const {\n          lat,\n          lng\n        } = convertTMtoLatLng(item.X, item.Y);\n        return {\n          id: `${item.STAT_ID}-${item.CHGER_ID}`,\n          stationId: item.STAT_ID,\n          name: item.STAT_NM,\n          address: item.ADRES,\n          operator: item.BUSI_NM,\n          chargerType: item.CHGER_TY,\n          useTime: item.USE_TM,\n          // ì¢Œí‘œ ë³€í™˜ ì ìš©\n          lat,\n          lng,\n          // Leaflet ë§ˆì»¤ ìƒíƒœ\n          status: \"available\",\n          // ì¶©ì „ê¸° í˜•íƒœ\n          chargers: [{\n            id: item.CHGER_ID,\n            type: item.CHGER_TY,\n            status: \"available\"\n          }]\n        };\n      }).filter(Boolean);\n      return mapped;\n    } catch (err) {\n      console.error(\"ðŸ”¥ SafeMap API Error:\", err);\n      throw new Error(\"ì‹¤ì œ API í˜¸ì¶œ ì‹¤íŒ¨\");\n    }\n  },\n  // ì§€ë„ ìš°ì¸¡ ìƒì„¸ì •ë³´ íŒ¨ë„ì—ì„œ ì‚¬ìš©\n  async getStationById(id) {\n    const stations = await this.getStations();\n    return stations.find(s => s.id === id);\n  },\n  // ê¸°ì¡´ í•„í„° ê¸°ëŠ¥ ê·¸ëŒ€ë¡œ\n  filterStations(stations, filters) {\n    if (!Array.isArray(stations)) return [];\n    return stations.filter(station => {\n      if (filters.statuses.length > 0 && !filters.statuses.includes(station.status)) {\n        return false;\n      }\n      if (filters.chargerTypes.length > 0) {\n        const hasType = station.chargers.some(c => filters.chargerTypes.includes(c.type));\n        if (!hasType) return false;\n      }\n      if (filters.companies.length > 0 && !filters.companies.includes(station.operator)) {\n        return false;\n      }\n      return true;\n    });\n  }\n};","map":{"version":3,"names":["proj4","API_URL","tmProjection","wgs84","convertTMtoLatLng","x","y","lng","lat","parseFloat","EVDataService","getStations","_ref","_ref2","_data$response$body$i","_data$response","_data$response$body","_data$response$body$i2","res","fetch","data","json","items","response","body","item","array","Array","isArray","mapped","map","X","Y","id","STAT_ID","CHGER_ID","stationId","name","STAT_NM","address","ADRES","operator","BUSI_NM","chargerType","CHGER_TY","useTime","USE_TM","status","chargers","type","filter","Boolean","err","console","error","Error","getStationById","stations","find","s","filterStations","filters","station","statuses","length","includes","chargerTypes","hasType","some","c","companies"],"sources":["/Users/jihongkim/Desktop/OSS_Final/src/components/ev/EvDataService.js"],"sourcesContent":["// EVDataService.js\nimport proj4 from \"proj4\";\n\nconst API_URL = \"http://localhost:4000/api/charging\";\n\n// TM ì¤‘ë¶€ì›ì (EPSG:2097) â†’ WGS84 ë³€í™˜ ì •ì˜\nconst tmProjection =\n  \"+proj=tmerc +lat_0=38 +lon_0=127 +k=1 +x_0=200000 +y_0=500000 +ellps=bessel +units=m +no_defs\";\nconst wgs84 = \"+proj=longlat +datum=WGS84 +no_defs\";\n\n// TM â†’ ìœ„ë„/ê²½ë„ ë³€í™˜ í•¨ìˆ˜\nfunction convertTMtoLatLng(x, y) {\n  const [lng, lat] = proj4(tmProjection, wgs84, [\n    parseFloat(x),\n    parseFloat(y),\n  ]);\n  return { lat, lng };\n}\n\nexport const EVDataService = {\n  // ðŸ”¥ ì‹¤ì œ SafeMap API í˜¸ì¶œ\n  async getStations() {\n    try {\n      const res = await fetch(API_URL);\n      const data = await res.json();\n\n      // SafeMap ì‘ë‹µ êµ¬ì¡°: { response: { body: { items: { item: [...] } } } }\n      const items =\n        data?.response?.body?.items?.item ??\n        data?.items ??\n        data?.item ??\n        [];\n\n      // ë°°ì—´ì´ ì•„ë‹ˆë©´ ë³€í™˜\n      const array = Array.isArray(items) ? items : [items];\n\n      // âš¡ Leafletì—ì„œ ì“°ê¸° ì¢‹ì€ êµ¬ì¡°ë¡œ ë³€í™˜\n      const mapped = array\n        .map((item) => {\n          if (!item.X || !item.Y) return null;\n\n          const { lat, lng } = convertTMtoLatLng(item.X, item.Y);\n\n          return {\n            id: `${item.STAT_ID}-${item.CHGER_ID}`,\n            stationId: item.STAT_ID,\n            name: item.STAT_NM,\n            address: item.ADRES,\n            operator: item.BUSI_NM,\n            chargerType: item.CHGER_TY,\n            useTime: item.USE_TM,\n\n            // ì¢Œí‘œ ë³€í™˜ ì ìš©\n            lat,\n            lng,\n\n            // Leaflet ë§ˆì»¤ ìƒíƒœ\n            status: \"available\",\n\n            // ì¶©ì „ê¸° í˜•íƒœ\n            chargers: [\n              {\n                id: item.CHGER_ID,\n                type: item.CHGER_TY,\n                status: \"available\",\n              },\n            ],\n          };\n        })\n        .filter(Boolean);\n\n      return mapped;\n    } catch (err) {\n      console.error(\"ðŸ”¥ SafeMap API Error:\", err);\n      throw new Error(\"ì‹¤ì œ API í˜¸ì¶œ ì‹¤íŒ¨\");\n    }\n  },\n\n  // ì§€ë„ ìš°ì¸¡ ìƒì„¸ì •ë³´ íŒ¨ë„ì—ì„œ ì‚¬ìš©\n  async getStationById(id) {\n    const stations = await this.getStations();\n    return stations.find((s) => s.id === id);\n  },\n\n  // ê¸°ì¡´ í•„í„° ê¸°ëŠ¥ ê·¸ëŒ€ë¡œ\n  filterStations(stations, filters) {\n    if (!Array.isArray(stations)) return [];\n\n    return stations.filter((station) => {\n      if (\n        filters.statuses.length > 0 &&\n        !filters.statuses.includes(station.status)\n      ) {\n        return false;\n      }\n\n      if (filters.chargerTypes.length > 0) {\n        const hasType = station.chargers.some((c) =>\n          filters.chargerTypes.includes(c.type)\n        );\n        if (!hasType) return false;\n      }\n\n      if (\n        filters.companies.length > 0 &&\n        !filters.companies.includes(station.operator)\n      ) {\n        return false;\n      }\n\n      return true;\n    });\n  },\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}